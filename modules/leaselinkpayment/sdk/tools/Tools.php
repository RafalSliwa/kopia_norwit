<?php class Tool{    public static function strtolower($str)    {        if (is_array($str))        {            return false;        }        if (function_exists('mb_strtolower'))        {            return mb_strtolower($str, 'utf-8');        }        return strtolower($str);    }    public static function strlen($str, $encoding = 'UTF-8')    {        if (is_array($str))        {            return false;        }        $str = html_entity_decode($str, ENT_COMPAT, 'UTF-8');        if (function_exists('mb_strlen'))        {            return mb_strlen($str, $encoding);        }        return strlen($str);    }    public static function file_get_contents($url, $use_include_path = false, $stream_context = null, $curl_timeout = 5)    {        if ($stream_context == null && preg_match('/^https?:\/\//', $url))        {            $stream_context = @stream_context_create(array(                'http' => array(                    'timeout' => $curl_timeout                 )            ));        }        if (in_array(ini_get('allow_url_fopen') , array(            'On',            'on',            '1'        )) || !preg_match('/^https?:\/\//', $url))        {            return @file_get_contents($url, $use_include_path, $stream_context);        }        elseif (function_exists('curl_init'))        {            $curl = curl_init();            curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);            curl_setopt($curl, CURLOPT_URL, $url);            curl_setopt($curl, CURLOPT_CONNECTTIMEOUT, 5);            curl_setopt($curl, CURLOPT_TIMEOUT, $curl_timeout);            curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, 0);            if ($stream_context != null)            {                $opts = stream_context_get_options($stream_context);                if (isset($opts['http']['method']) && Tools::strtolower($opts['http']['method']) == 'post')                {                    curl_setopt($curl, CURLOPT_POST, true);                    if (isset($opts['http']['content']))                    {                        parse_str($opts['http']['content'], $post_data);                        curl_setopt($curl, CURLOPT_POSTFIELDS, $post_data);                    }                }            }            $content = curl_exec($curl);            curl_close($curl);            return $content;        }        else        {            return false;        }    }    /**     * jsonDecode convert json string to php array / object     *     * @param string $json     * @param bool $assoc  (since 1.4.2.4) if true, convert to associativ array     * @return array     */    public static function jsonDecode($json, $assoc = false)    {        if (function_exists('json_decode'))        {            return json_decode($json, $assoc);        }        else        {            include_once ('json/json.php');            $pear_json = new Services_JSON(($assoc) ? SERVICES_JSON_LOOSE_TYPE : 0);            return $pear_json->decode($json);        }    }    /**     * Convert an array to json string     *     * @param array $data     * @return string json     */    public static function jsonEncode($data)    {        if (function_exists('json_encode'))        {            return json_encode($data);        }        else        {            include_once ('json/json.php');            $pear_json = new Services_JSON();            return $pear_json->encode($data);        }    }}